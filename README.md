# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:

- src/ — исходные файлы проекта
- src/components/ — папка с TS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:

- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск

Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```

## Сборка

```
npm run build
```

или

```
yarn build
```

## Типы данных

    type price = number | null - товар может быт с ценой, так и без нее (0)

    type payment = 'cash' | 'card' - способы оплаты: карта или наличные

    type category =
    | 'другое'
    | 'софт-скил'
    | 'дополнительное'
    | 'кнопка'
    | 'хард-скил'; - категории товаров

## Описание данных (интерфейсы)

Интерфейс карточки товара IProduct

    - id: string - id карточки товара
    - title: string - название карточки товара
    - category: category - категория товара
    - description: string - описание товара
    - price: price - цена товара (может быть с нулевым значением, так как есть бесценные товары)
    - image: string - изображение товара
    - buyButton: string - кнопка "Купить"

Интерфейс заказа IOrder

    - payment: payment - способ оплаты
    - mail: string - электронный адрес
    - phone: string - телефон
    - address: string - адрес
    - total: number - итоговая сумма заказа
    - items: string[] - массив товаров в заказе

Интерфейс корзины IBasket

    - items: string[] - массив товаро в корзине
    - total: price; - итоговая стоимость (если в корзину добавлены только товары из категории "Бесценно" - стоимость 0)

Интерфейс результата заказа IOrderResult

    - id: string - идентификатор заказа
    - total: price - итоговая стоимость

Интерфейс страницы IPage

    - cards: IProduct[] - массив карточек товар
    - total: number - количество карточек

Интерфейс валидации форм IValidationForm

    - valid: boolean - валидация формы булевым значением
    - errors: string[] сообщение/я об ошибке/ах


## Модели данных (классы)

## Базовый код

Класс Api

Содержит в себе базовую логику отправки запросов. В конструктор передается базовый адрес сервера и опциональный объект с заголовками запросов.\
Методы:

    'get' - выполняет GET запрос на переданный в параметрах ендпоинт и возвращает промис с объектом, которым ответил сервер

    'post' - принимает объект с данными, которые будут переданы в JSON в теле запроса, и отправляет эти данные на ендпоинт переданный как параметр при вызове метода. По умолчанию выполняется POST запрос, но метод запроса может быть переопределен заданием третьего параметра при вызове.

Класс EventEmitter

Брокер событий позволяет отправлять события и подписываться на события, происходящие в системе. Класс используется в презентере для обработки событий и в слоях приложения для генерации событий.
Основные методы, реализуемые классом описаны интерфейсом IEvents:

    'on' - подписка на событие
    'emit' - инициализация события
    'trigger' - возвращает функцию, при вызове которой инициализируется требуемое в параметрах событие

## Компоненты

Абстрактный класс принимает конструктором контейнер (DOM элемент). Содержит в себе базовые методы для работы с элементами в DOM:

  - toggleClass() -переключить класс 
  - setText() - установить текст для элемента
  - setDisabled() -заблокировать/разблокировать элемент(к примеру кнопка, атрибут disabled)
  - setHidden() - скрыть элемент
  - setVisible() - показать элемент
  - setImage() - установить изображение
  - render() - возвращает HTML элемент 

## Слой данных

### Класс AppState для работы с данными.

Поля класса:
items - 
basket - 
userData - 
formErrors - 
preview - 
Конструктор - 
Сеттеры:
items()
user()
Геттеры:
itemsList()
user()
basketItems()
totalBasketPrice()
countBasket()
formErrorsList()
Методы:
setPreview()
getBasketId()
 getItemById()
addBasket()
deleteBasket()
 clearBasket()
 validateContact()
clearOrder()
addOrderField()
 hasProductInBasket()
 clearOrderData()

### Класс Page

Класс для отрисовки главной страницы

Поля:
hdrBasketCounter
gallery
pageWrapper
 hdrBasket
Конструктором:
Сеттеры:
counter()
catalog()
locked()

### Класс Success

## Взаимодействие компорнентов

Основные события, возникающие при взаимодействии пользователя с интерфейсом

    - basket:toOrder — событие, которое происходит при нажатии на кнопку «Оформить» в корзине. Как итог, открывается модальное окно с выбором способа оплаты и адреса, куда доставить товар.
    - basket:toContacts — событие, происходящее при клике на кнопку «Оформить». После этого открывается модальное окно, в котором необходимо заполнять поля контактов.
    - orderInput:change — событие, возникающее при вводе данных в форму заказа Order и контактов Contacts. С помощью данного события активируется валидация. + сохраняются значения из инпутов в поля объекта
    - contacts:submit - событие отправки контактной информации при оформлении заказа
    - order:success — событие, вызываемое успешным ответом сервера при оплате товара. Оно открывает модальное окно, информирующее об успешной оплате.
    - input:error — событие, выполняющее проверку формы и возвращающее ошибки формы.
    - modal:open - событие происходящее при нажатии на карточку товара для открытия её предпросмотра.
    - modal:close — событие, происходящее при клике на кнопку закрытия, клике вне модального окна или по клавише Esc. Оно приводит к закрытию модального окна.
    - items:changed — событие, которое происходит при изменении списка товаров и вызывает перерисовку списка товаров на странице.
    - card:select — событие, инициируемое при клике на карточку товара. Получает данные о ней — объект конкретного товара.
    - preview:change — событие, возникающее при передаче моделью новых данных. Оповещает View и приводит к отрисовке содержимого модального окна.
    - basket: add — событие, инициированное при клике на кнопку «В корзину». Приводит к добавлению товара в корзину и перерисовке счётчика корзины на главной.
    - basket:open — событие, запускаемое при клике на значок корзины. Приводит к открытию модального окна с выбранными товарами и итоговой ценой.
    - basket:remove — событие, вызванное кликом на значок корзины внутри самой корзины. Вызывает перерисовку списка товаров и счётчика на главной странице.

    

